<!doctype html>
<html lang="en">
  <head>
    <title>Charlie</title>
    <style type="text/css">
      body {
        font-family: sans-serif;
      }

      h4 {
        margin: 20px 0 0 0;
      }

      ul {
        margin: 0 0 20px 0;
      }

      #container {
        display: grid;
        grid-template-columns: 250px auto;
        left: 0;
        position: absolute;
        top: 0;
      }

      #controls {
        background-color: #333;
        color: white;
        min-height: 100vh;
        padding: 0 20px;
      }

      #parts {
        display: none;
      }
    </style>
  </head>
  <body>
    <div id="container">
      <div id="controls">
        <h4>Outerwear</h4>
        <select>
          <option checked="checked">None</option>

          <option value="hoodie_black">Black hoodie</option>
          <option value="hoodie_blue">Blue hoodie</option>
          <option value="hoodie_green">Gree hoodie</option>
          <option value="hoodie_red">Red hoodie</option>

          <option value="hoodie_giraffe">Giraffe hoodie</option>

          <option value="sweater_blue">Blue sweater</option>
          <option value="sweater_green">Green sweater</option>
          <option value="sweater_purple">Purple sweater</option>
          <option value="sweater_red">Red sweater</option>
          <option value="sweater_yellow">Lime sweater</option>
        </select>

        <h4>Logo patch</h4>
        <select>
          <option checked="checked">None</option>
          <option value="logo_18f">18F</option>
          <option value="logo_challengegov">Challenge.gov</option>
          <option value="logo_cloudgov">Cloud.gov</option>
          <option value="logo_coe">COE</option>
          <option value="logo_digitalgov">DigitalGov</option>
          <option value="logo_digitalgov-university">
            DigitalGov University
          </option>
          <option value="logo_federalist">Federalist</option>
          <option value="logo_fedramp">FedRAMP</option>
          <option value="logo_logingov">Login.gov</option>
          <option value="logo_pif">PIF</option>
          <option value="logo_searchgov">Search.gov</option>
          <option value="logo_usagov">USA.gov</option>
        </select>

        <h4>Bow tie</h4>
        <select>
          <option checked="checked">None</option>
          <option value="bowtie_blue">Blue</option>
          <option value="bowtie_pink">Pink</option>
        </select>
        <br />
        <label>
          <input type="checkbox" value="antennabow_blue" />
          Antenna bow
        </label>

        <h4>Makeup</h4>
        <label>
          <input type="checkbox" value="lipstick" />
          Lipstick
        </label>
        <br />
        <select>
          <option checked="checked">None</option>
          <option value="blush_pink">Pink blush</option>
          <option value="blush_purple">Purple blush</option>
        </select>

        <h4>Eyes</h4>
        <select>
          <option value="eye_triangle" checked="checked">Happy eyes</option>
          <option value="eye_round">Empty round eyes</option>
          <option value="eye_round_pupil">Nervous round eyes</option>
          <option value="eye_round_side">Side round eyes</option>
        </select>

        <h4>Eyelashes</h4>
        <select>
          <option checked="checked">None</option>
          <option value="eyelash_long">Long</option>
          <option value="eyelash_outside">Outside</option>
          <option value="eyelash_short">Short</option>
          <option value="eyelash_top">Top</option>
        </select>

        <br /><br />
        <button id="save" type="button">Save</button>
      </div>

      <div id="parts">
        <img src="parts/0_antenna.png" data-layer="0" />

        <img
          src="parts/1_hoodie_black.png"
          data-layer="1"
          data-element="hoodie_black"
        />
        <img
          src="parts/1_hoodie_blue.png"
          data-layer="1"
          data-element="hoodie_blue"
        />
        <img
          src="parts/1_hoodie_green.png"
          data-layer="1"
          data-element="hoodie_green"
        />
        <img
          src="parts/1_hoodie_red.png"
          data-layer="1"
          data-element="hoodie_red"
        />
        <img
          src="parts/1_hoodie_giraffe.png"
          data-layer="1"
          data-element="hoodie_giraffe"
        />

        <img src="parts/2_body_orange.png" data-layer="2" />

        <img
          src="parts/3_sweater_blue.png"
          data-layer="3"
          data-element="sweater_blue"
        />
        <img
          src="parts/3_sweater_green.png"
          data-layer="3"
          data-element="sweater_green"
        />
        <img
          src="parts/3_sweater_purple.png"
          data-layer="3"
          data-element="sweater_purple"
        />
        <img
          src="parts/3_sweater_red.png"
          data-layer="3"
          data-element="sweater_red"
        />
        <img
          src="parts/3_sweater_yellow.png"
          data-layer="3"
          data-element="sweater_yellow"
        />

        <img src="parts/4_body_outline.png" data-layer="4" />

        <img
          src="parts/5_hoodie_shadow.png"
          data-layer="5"
          data-element="hoodie_black"
        />
        <img
          src="parts/5_hoodie_shadow.png"
          data-layer="5"
          data-element="hoodie_giraffe"
        />

        <img src="parts/6_neck.png" data-layer="6" />

        <img
          src="parts/7_blush_pink.png"
          data-layer="7"
          data-element="blush_pink"
        />
        <img
          src="parts/7_blush_purple.png"
          data-layer="7"
          data-element="blush_purple"
        />

        <img
          src="parts/8_lipstick.png"
          data-layer="8"
          data-element="lipstick"
        />

        <img src="parts/9_mouth_fill.png" data-layer="9" />

        <img src="parts/10_mouth_outline.png" data-layer="10" />

        <img
          src="parts/11_eye_round_fill.png"
          data-layer="11"
          data-element="eye_round"
        />
        <img
          src="parts/11_eye_round_fill.png"
          data-layer="11"
          data-element="eye_round_pupil"
        />
        <img
          src="parts/11_eye_round_fill.png"
          data-layer="11"
          data-element="eye_round_side"
        />

        <img
          src="parts/12_eye_round_pupil.png"
          data-layer="12"
          data-element="eye_round_pupil"
        />
        <img
          src="parts/12_eye_round_side.png"
          data-layer="11"
          data-element="eye_round_side"
        />

        <img
          src="parts/13_eye_round_outline.png"
          data-layer="13"
          data-element="eye_round"
        />
        <img
          src="parts/13_eye_round_outline.png"
          data-layer="13"
          data-element="eye_round_pupil"
        />
        <img
          src="parts/13_eye_round_outline.png"
          data-layer="13"
          data-element="eye_round_side"
        />
        <img
          src="parts/13_eye_triangle.png"
          data-layer="13"
          data-element="eye_triangle"
        />

        <img
          src="parts/14_eyelash_long.png"
          data-layer="14"
          data-element="eyelash_long"
        />
        <img
          src="parts/14_eyelash_outside.png"
          data-layer="14"
          data-element="eyelash_outside"
        />
        <img
          src="parts/14_eyelash_short.png"
          data-layer="14"
          data-element="eyelash_short"
        />
        <img
          src="parts/14_eyelash_top.png"
          data-layer="14"
          data-element="eyelash_top"
        />

        <img
          src="parts/15_hoodie_black.png"
          data-layer="15"
          data-element="hoodie_black"
        />
        <img
          src="parts/15_hoodie_blue.png"
          data-layer="15"
          data-element="hoodie_blue"
        />
        <img
          src="parts/15_hoodie_green.png"
          data-layer="15"
          data-element="hoodie_green"
        />
        <img
          src="parts/15_hoodie_red.png"
          data-layer="15"
          data-element="hoodie_red"
        />
        <img
          src="parts/15_hoodie_giraffe.png"
          data-layer="15"
          data-element="hoodie_giraffe"
        />

        <img
          src="parts/16_logo_18f.png"
          data-layer="16"
          data-element="logo_18f"
        />
        <img
          src="parts/16_logo_challengegov.png"
          data-layer="16"
          data-element="logo_challengegov"
        />
        <img
          src="parts/16_logo_cloudgov.png"
          data-layer="16"
          data-element="logo_cloudgov"
        />
        <img
          src="parts/16_logo_coe.png"
          data-layer="16"
          data-element="logo_coe"
        />
        <img
          src="parts/16_logo_digitalgov.png"
          data-layer="16"
          data-element="logo_digitalgov"
        />
        <img
          src="parts/16_logo_digitalgov-university.png"
          data-layer="16"
          data-element="logo_digitalgov-university"
        />
        <img
          src="parts/16_logo_federalist.png"
          data-layer="16"
          data-element="logo_federalist"
        />
        <img
          src="parts/16_logo_fedramp.png"
          data-layer="16"
          data-element="logo_fedramp"
        />
        <img
          src="parts/16_logo_logingov.png"
          data-layer="16"
          data-element="logo_logingov"
        />
        <img
          src="parts/16_logo_pif.png"
          data-layer="16"
          data-element="logo_pif"
        />
        <img
          src="parts/16_logo_searchgov.png"
          data-layer="16"
          data-element="logo_searchgov"
        />
        <img
          src="parts/16_logo_usagov.png"
          data-layer="16"
          data-element="logo_usagov"
        />

        <img
          src="parts/17_bowtie_blue.png"
          data-layer="17"
          data-element="bowtie_blue"
        />
        <img
          src="parts/17_bowtie_pink.png"
          data-layer="17"
          data-element="bowtie_pink"
        />

        <img
          src="parts/18_bowtie_outline.png"
          data-layer="18"
          data-element="bowtie_blue"
        />
        <img
          src="parts/18_bowtie_outline.png"
          data-layer="18"
          data-element="bowtie_pink"
        />

        <img
          src="parts/19_antennabow_blue.png"
          data-layer="19"
          data-element="antennabow_blue"
        />

        <img
          src="parts/20_antennabow_outline.png"
          data-layer="20"
          data-element="antennabow_blue"
        />
      </div>

      <div id="charlie">
        <canvas width="660" height="780"></canvas>
      </div>
    </div>

    <script type="text/javascript">
      const $ = (selector) => Array.from(document.querySelectorAll(selector));

      const images = $("#parts img").sort(
        (a, b) => a.dataset.layer - b.dataset.layer,
      );

      const canvas = $("#charlie canvas")[0];
      const context = canvas?.getContext("2d");

      const controlsChanged = () => {
        $("[data-element]").forEach((element) => {
          element.style.display = "none";
        });
        context?.clearRect(0, 0, canvas.width, canvas.height);

        const enabled = new Set();

        $("select").forEach((element) => {
          enabled.add(element.value);
        });

        $("input")
          .filter((element) => element.checked)
          .forEach((element) => {
            enabled.add(element.value);
          });

        for (const image of images) {
          if (!image.dataset.element || enabled.has(image.dataset.element)) {
            context?.drawImage(image, 0, 0);
          }
        }
      };

      $("input, select").forEach((input) => {
        input.addEventListener("change", controlsChanged);
      });

      setTimeout(controlsChanged, 100);

      $("#save")[0].addEventListener("click", () => {
        canvas.toBlob((blob) => {
          const url = URL.createObjectURL(blob);
          const link = document.createElement("a");
          link.href = url;
          link.download = "charlie.png";
          link.click();
          setTimeout(() => {
            URL.revokeObjectURL(url);
          }, 500);
        }, "image/png");
      });
    </script>
  </body>
</html>
